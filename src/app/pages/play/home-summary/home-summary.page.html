<ion-header>
  <ion-toolbar>
    <ion-buttons slot="start">
      <ion-back-button defaultHref="/play/summary"></ion-back-button>
    </ion-buttons>
    <ion-tab-button
      [routerLink]="['/play/superadmin-admins']"
      slot="end"
      *ngIf="(userInfo$ | async)?.appRole === 'SUPERADMIN'"
    >
      <fa-icon class="p-1 logo-yellow" [icon]="faComputer" size="2x"></fa-icon>
      <ion-label>admin</ion-label>
    </ion-tab-button>
    <ion-tab-button slot="end" [routerLink]="['/play/help']">
      <fa-icon
        class="p-1 logo-blue"
        [icon]="faQuestionCircle"
        size="2x"
      ></fa-icon>
      <ion-label>Help</ion-label>
    </ion-tab-button>
  </ion-toolbar>
</ion-header>

<ion-content scroll-y="false">
  <app-tabs-summary></app-tabs-summary>

  <div *ngIf="profileInfo$ | async as profileInfo; else loadingIndicator">
    <div *ngIf="userInfo$ | async as userInfo">
      <ng-container *ngIf="profileInfo; else noContent">
        <h1>{{ profileInfo.firstName }} {{ profileInfo.lastName }}</h1>
        <h2 class="xp-styling">
          <fa-icon class="p-1" [icon]="faStar" size="1x"></fa-icon>
          XP: {{ profileInfo.experiencePoints }}
        </h2>

        <div
          *ngIf="userActivitiesOpenFull$ | async as activities; else loadingIndicator"
        >
          <h2 class="bottom1px">Scheduled Activities</h2>
          <ng-container
            *ngIf="activities && activities.length > 0; else noContent"
          >
            <ul class="activities">
              <li *ngFor="let activity of activities">
                <a href="play/activity-details/{{ activity.id }}">
                  <span class="field">{{ activity.name }}</span>
                  <span class="field">
                    {{ activity.activityDate | date: 'dd-MM-yyyy' }}
                    <fa-icon
                      class="p-1 infocircle"
                      [ngClass]="userInfo.id == activity.ownerId ? 'logo-yellow' : 'logo-blue'"
                      [icon]="faInfoCircle"
                      size="1x"
                    ></fa-icon>
                  </span>
                </a>
              </li>
            </ul>
          </ng-container>
        </div>

        <div
          *ngIf="userActivitiesWithScores$ | async as activities; else loadingIndicator"
        >
          <h2 class="bottom1px morepaddingtop">Recent History</h2>
          <ng-container
            *ngIf="activities && activities.length > 0; else noContent"
          >
            <ul class="activities">
              <li *ngFor="let activity of activities">
                <a href="play/activity-details/{{ activity.id }}">
                  <span class="field">{{ activity.name }}</span>
                  <span class="field">
                    {{ activity.result }}
                    <fa-icon
                      class="p-1 infocircle"
                      [ngClass]="userInfo.id == activity.ownerId ? 'logo-yellow' : 'logo-blue'"
                      [icon]="faInfoCircle"
                      size="1x"
                    ></fa-icon>
                  </span>
                </a>
              </li>
            </ul>
          </ng-container>
        </div>
      </ng-container>
    </div>
  </div>
</ion-content>

<ng-template #loadingIndicator>
  <app-loading-indicator></app-loading-indicator>
</ng-template>

<ng-template #noContent>
  <h2 class="nocontent">(No content)</h2>
</ng-template>
