<ion-header>
  <ion-toolbar *transloco="let t">
    <ion-buttons slot="start">
      <ion-back-button [text]="isPlatform('ios') ? t('back'): undefined"/>
    </ion-buttons>
    <ion-title>{{ myProfile ? t("profile.header.title") : t("profile.title") }}</ion-title>
  </ion-toolbar>
  <app-connectivity-error/>
</ion-header>

<ion-content *transloco="let t">
  <ion-refresher
    (ionRefresh)="refreshProfileData($any($event))"
    *ngIf="!profileLoading"
    [pullFactor]="0.5"
    [pullMax]="200"
    [pullMin]="100"
    slot="fixed"
  >
    <ion-refresher-content/>
  </ion-refresher>

  <div
    class="flex flex-col justify-center text-center">
    <div>
      <app-loading-indicator *ngIf="profilePictureLoading"/>
      <div *ngIf="!profilePictureLoading"
           class="abc-border-image mt-6 mx-auto w-1/2 xl:w-1/5 x sm:w-1/3">
        <img alt="profile picture" class="abc-profile-image round p-4" src="{{profilePicture}}"/>
      </div>
    </div>
  </div>

  <div *ngIf="!profileLoading" class="flex flex-col justify-center text-center">
    <ion-text class="pt-4 text-2xl">{{ profile?.displayName }}</ion-text>
    <ion-text class="p-1" color="medium"
    >{{
        profile?.jobTitle!.substring(0, 1).toUpperCase() +
        profile?.jobTitle!.substring(1)
      }}
    </ion-text>
  </div>

  <div *ngIf="profile?.manager">
    <app-user-card [manager]="true" [user]="profile?.manager!"/>
  </div>

  <ion-card>
    <ion-card-header>
      <ion-segment
        (ionChange)="segmentChanged($event)"
        [swipeGesture]="true"
        color="danger"
        scrollable="true"
        value="{{profile_tab}}"
      >
        <ion-segment-button value="profile">
          <fa-icon [icon]="faUser" class="p-2" size="2x"/>
        </ion-segment-button>
        <ion-segment-button *ngIf="employee?.experiences!.length >0" value="experience">
          <fa-icon [icon]="faBriefcase" class="p-2" size="2x"/>
        </ion-segment-button>
        <ion-segment-button *ngIf="employee?.educations!.length >0" value="educations">
          <fa-icon [icon]="faGraduationCap" class="p-2" size="2x"/>
        </ion-segment-button>
        <ion-segment-button *ngIf="employee?.competences!.length >0" value="competences">
          <fa-icon [icon]="faRankingStar" class="p-2" size="2x"/>
        </ion-segment-button>
        <ion-segment-button *ngIf="employee?.courses!.length >0" value="courses">
          <fa-icon [icon]="faBook" class="p-2" size="2x"/>
        </ion-segment-button>
        <ion-segment-button *ngIf="employee?.certificates!.length >0" value="certificates">
          <fa-icon [icon]="faAward" class="p-2" size="2x"/>
        </ion-segment-button>
        <ion-segment-button *ngIf="employee?.languages!.length >0" value="languages">
          <fa-icon [icon]="faLanguage" class="p-2" size="2x"/>
        </ion-segment-button>
        <ion-segment-button *ngIf="employee?.exams!.length >0" value="exams">
          <fa-icon [icon]="faCheckDouble" class="p-2" size="2x"/>
        </ion-segment-button>
      </ion-segment>
    </ion-card-header>
    <ion-card-content>
      <div *ngIf="profileLoading">
        <app-loading-indicator></app-loading-indicator>
      </div>
      <div *ngIf="!profileLoading && profile_tab==='profile'">
        <app-basic-info [profile]="profile"/>
      </div>
      <div *ngIf="profile_tab==='experience' && employee?.experiences!.length >0">
        <app-expierences [experiences]="employee?.experiences"/>
      </div>
      <div *ngIf="profile_tab==='educations' && employee?.educations!.length >0">
        <app-educations [educations]="employee?.educations"/>
      </div>
      <div *ngIf="profile_tab==='competences' && employee?.competences!.length >0">
        <app-competences [competences]="employee?.competences"/>
      </div>
      <div *ngIf="profile_tab==='courses' && employee?.courses!.length >0">
        <app-courses [courses]="employee?.courses"/>
      </div>
      <div *ngIf="profile_tab==='certificates' && employee?.certificates!.length >0">
        <app-certificates [certificates]="employee?.certificates"/>
      </div>
      <div *ngIf="profile_tab==='languages' && employee?.languages!.length >0">
        <app-languages [languages]="employee?.languages"/>
      </div>
      <div *ngIf="profile_tab==='exams' && employee?.exams!.length >0">
        <app-exams [exams]="employee?.exams"/>
      </div>

    </ion-card-content>
  </ion-card>


</ion-content>
